from pwn import *
from Crypto.Cipher import AES

# io = process("./hell")
p = remote("13.233.166.242",49155)

g = 13061880230110805485346525688018595113271880103717720219673350299083396780730251766148414377512386061643807530751287373200960399392170617293251618992497053
p = [1697841911,1438810907,666397859,941857673]
private = 3

res = []

for i in p:
	res.append(pow(g,private,i))

print(io.recvuntil("Enter the public values"))

io.sendline(str(res[0]))
io.sendline(str(res[1]))
io.sendline(str(res[2]))
io.sendline(str(res[3]))

data = [220422733,801253003,596847162,571072501]
key = []

for i in range(len(data)):
	key.append(pow(data[i],private,p[i]))

key=p32(key[0])+p32(key[1])+p32(key[2])+p32(key[3])

cipher=AES.new(key,AES.MODE_CBC,b"\x00"*16)
code='darkCON{d1ff13_h3llm4n_1s_vuln3r'
ct=cipher.encrypt(code)

print(io.recvuntil("Enter the code"))

io.send(ct)

data = io.recvall(timeout=2)
data = data.split(":")[2]
data = data.split(" ")[1:-1]

encrypt_data = ''

for i in data:
	c = int(i,16)
	encrypt_data = encrypt_data + chr(c)

cipher=AES.new(key,AES.MODE_CBC,b"\x00"*16)
data = cipher.decrypt(encrypt_data)
print(data)
